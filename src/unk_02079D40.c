#include <nitro.h>
#include <string.h>

#include "struct_defs/struct_02073C74.h"
#include "struct_defs/struct_02073C74_sub1.h"

#include "unk_02073C2C.h"
#include "unk_02079D40.h"

#include "constants/species.h"

const u8 Unk_020F0780[] = {
	0x0,
	0x1,
	0x1,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x1,
	0x1,
	0x0,
	0x1,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x2,
	0x1,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x0,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x0,
	0x0,
	0x2,
	0x1,
	0x0,
	0x0,
	0x2,
	0x2,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x1,
	0x1,
	0x1,
	0x2,
	0x1,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x0,
	0x2,
	0x0,
	0x1,
	0x1,
	0x1,
	0x2,
	0x2,
	0x1,
	0x1,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x1,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x1,
	0x1,
	0x1,
	0x2,
	0x2,
	0x1,
	0x2,
	0x2,
	0x1,
	0x1,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x1,
	0x2,
	0x1,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x0,
	0x0,
	0x1,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x1,
	0x2,
	0x2,
	0x0,
	0x0,
	0x2,
	0x0,
	0x0,
	0x1,
	0x2,
	0x2,
	0x1,
	0x1,
	0x1,
	0x1,
	0x2,
	0x2,
	0x1,
	0x1,
	0x1,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x2,
	0x2,
	0x2,
	0x0,
	0x0,
	0x2,
	0x0,
	0x0,
	0x1,
	0x2,
	0x0,
	0x0,
	0x2,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x1,
	0x2,
	0x2,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x0,
	0x2,
	0x0,
	0x1,
	0x0,
	0x1,
	0x0,
	0x1,
	0x1,
	0x1,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x2,
	0x0,
	0x2,
	0x0,
	0x2,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x1,
	0x1,
	0x1,
	0x2,
	0x0,
	0x1,
	0x1,
	0x2,
	0x2,
	0x1,
	0x1,
	0x1,
	0x1,
	0x0,
	0x2,
	0x2,
	0x2,
	0x1,
	0x2,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x0,
	0x1,
	0x2,
	0x0,
	0x0,
	0x2,
	0x0,
	0x1,
	0x0,
	0x1,
	0x0,
	0x2,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x1,
	0x0,
	0x0,
	0x0,
	0x2,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x2,
	0x0,
	0x0,
	0x0,
	0x2,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x2,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x1,
	0x0,
	0x0,
	0x1,
	0x1,
	0x1,
	0x1,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x1,
	0x1,
	0x1,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x2,
	0x2,
	0x0,
	0x1,
	0x0,
	0x2,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x2,
	0x1,
	0x1,
	0x0,
	0x2,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x1,
	0x1,
	0x0,
	0x0,
	0x1,
	0x0,
	0x2,
	0x1,
	0x0,
	0x2,
	0x1,
	0x1,
	0x0,
	0x2,
	0x2,
	0x0,
	0x1,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x2,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x1,
	0x2,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x1,
	0x0,
	0x0,
	0x0,
	0x0,
	0x0
};


u32 sub_02079D40(const BoxPokemon *boxMon)
{
    u32 v0;
    u32 v1;
    BOOL v2;
    u32 v3;
    u32 v4;

    v2 = sub_02073D20((BoxPokemon *)boxMon);
    v0 = sub_02074570((BoxPokemon *)boxMon, MON_DATA_SPECIES, NULL);
    v4 = sub_02074570((BoxPokemon *)boxMon, MON_DATA_IS_EGG, NULL);
    v3 = sub_02079E44((BoxPokemon *)boxMon);
    v1 = sub_02079D8C(v0, v4, v3);

    sub_02073D48((BoxPokemon *)boxMon, v2);
    return v1;
}

u32 sub_02079D80(Pokemon *mon)
{
    return sub_02079D40((const BoxPokemon *)sub_02076B10(mon));
}

u32 sub_02079D8C(u32 species, u32 param1, u32 param2)
{
    if (param1 == 1) {
        if (species == SPECIES_MANAPHY)
            return 502;
        else
            return 501;
    }

    param2 = SanitizeFormId(species, param2);

    if (param2 != 0) {
        if (species == SPECIES_DEOXYS)
            return 503 + param2 - 1;
        if (species == SPECIES_UNOWN)
            return 507 + param2 - 1;
        if (species == SPECIES_BURMY)
            return 534 + param2 - 1;
        if (species == SPECIES_WORMADAM)
            return 536 + param2 - 1;
        if (species == SPECIES_SHELLOS)
            return 538 + param2 - 1;
        if (species == SPECIES_GASTRODON)
            return 539 + param2 - 1;
        if (species == SPECIES_GIRATINA)
            return 540 + param2 - 1;
        if (species == SPECIES_SHAYMIN)
            return 541 + param2 - 1;
        if (species == SPECIES_ROTOM)
            return 542 + param2 - 1;
    }

    if (species > NATIONAL_DEX_COUNT) {
        species = 0;
    }

    return 7 + species;
}

u16 sub_02079E44 (const BoxPokemon *boxMon)
{
    u32 species;

    species = sub_02074570((BoxPokemon *)boxMon, MON_DATA_SPECIES_EGG, NULL);

    switch (species) {
    case SPECIES_UNOWN:
        return sub_02076B00((BoxPokemon *)boxMon);
    case SPECIES_DEOXYS:
    case SPECIES_BURMY:
    case SPECIES_WORMADAM:
    case SPECIES_SHELLOS:
    case SPECIES_GASTRODON:
    case SPECIES_GIRATINA:
    case SPECIES_SHAYMIN:
    case SPECIES_ROTOM:
        return sub_02074570((BoxPokemon *)boxMon, MON_DATA_FORM, NULL);
    default:
        return 0;
    }

    return 0;
}

const u8 sub_02079EDC(u32 species, u32 formId, u32 isEgg)
{
    if (isEgg == TRUE) {
        if (species == SPECIES_MANAPHY)
            species = SPECIES_EGG_MANAPHY;
        else
            species = SPECIES_EGG;
    } else if (species > SPECIES_ARCEUS)
        species = SPECIES_NONE;
    else if (formId != 0) {
        if (species == SPECIES_DEOXYS)
            species = SPECIES_DEOXYS_ATTACK + formId - 1;
        else if (species == SPECIES_UNOWN)
            species = SPECIES_UNOWN_B + formId - 1;
        else if (species == SPECIES_BURMY)
            species = 495 + 5 + 27 + formId - 1;
        else if (species == SPECIES_WORMADAM)
            species = 495 + 5 + 29 + formId - 1;
        else if (species == SPECIES_SHELLOS)
            species = 495 + 5 + 31 + formId - 1;
        else if (species == SPECIES_GASTRODON)
            species = 495 + 5 + 32 + formId - 1;
        else if (species == SPECIES_GIRATINA)
            species = 495 + 5 + 33 + formId - 1;
        else if (species == SPECIES_SHAYMIN)
            species = 495 + 5 + 34 + formId - 1;
        else if (species == SPECIES_ROTOM)
            species = 495 + 5 + 35 + formId - 1;
    }

    return Unk_020F0780[species];
}

const u8 sub_02079F84 (const BoxPokemon *boxMon)
{
    BOOL v0;
    u32 species;
    u32 v2;
    u32 isEgg;

    v0 = sub_02073D20((BoxPokemon *)boxMon);
    v2 = sub_02079E44(boxMon);
    species = sub_02074570((BoxPokemon *)boxMon, MON_DATA_SPECIES, NULL);
    isEgg = sub_02074570((BoxPokemon *)boxMon, MON_DATA_IS_EGG, NULL);

    sub_02073D48((BoxPokemon *)boxMon, v0);

    return sub_02079EDC(species, v2, isEgg);
}

const u8 sub_02079FC4 (Pokemon *mon)
{
    return sub_02079F84((const BoxPokemon *)sub_02076B10(mon));
}

u32 sub_02079FD0 (void)
{
    return 0;
}

u32 sub_02079FD4 (void)
{
    return 2;
}

u32 sub_02079FD8 (void)
{
    return 4;
}

u32 sub_02079FDC (void)
{
    return 6;
}

u32 sub_02079FE0 (void)
{
    return 1;
}

u32 sub_02079FE4 (void)
{
    return 3;
}

u32 sub_02079FE8 (void)
{
    return 5;
}
