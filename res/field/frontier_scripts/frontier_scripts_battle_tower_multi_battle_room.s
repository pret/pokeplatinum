# include "macros/frscrcmd.inc"
# include "res/text/bank/battle_tower_multi_battle_room.h"

    .data

    .long _0172 - 4
    .short 0xFD13

    .balign 4, 0
_0008:
    .short 0xEEEE
    .byte 0x00
    .short 0x800F
    .byte 0x01
    .short 0x800A
    .byte 0x01
    .short 0xFD13

    .balign 4, 0
_0014:
    .short 0xEEEE
    .byte 0x00
    .short 0xEEEF
    .byte 0x00
    .short 0x800F
    .byte 0x01
    .short 0xFD13

    .balign 4, 0
_0020:
    .short 0x800B
    .byte 0x01
    .short 0x800C
    .byte 0x01
    .short 0xFD13

    .balign 4, 0
_0028:
    .short 0x0000
    .short 0xEEEE
    .byte 0x01
    .short 0x0078
    .short 0x0078
    .byte 0x00
    .byte 0x00
    .short 0x0001
    .short 0x800F
    .byte 0x03
    .short 0x0028
    .short 0x0068
    .byte 0x01
    .byte 0x01
    .short 0x0002
    .short 0x800F
    .byte 0x03
    .short 0x0028
    .short 0x0078
    .byte 0x01
    .byte 0x01
    .short 0x0005
    .short 0x8009
    .byte 0x00
    .short 0x0078
    .short 0x00A8
    .byte 0x01
    .byte 0x01
    .short 0x0006
    .short 0x800A
    .byte 0x00
    .short 0x0088
    .short 0x00A8
    .byte 0x01
    .byte 0x01
    .short 0xFD13

    .balign 4, 0
_0064:
    .short 0x0000
    .short 0xEEEE
    .byte 0x01
    .short 0x0078
    .short 0x0078
    .byte 0x00
    .byte 0x00
    .short 0x0001
    .short 0x800F
    .byte 0x03
    .short 0x0028
    .short 0x0068
    .byte 0x01
    .byte 0x01
    .short 0x0002
    .short 0x800F
    .byte 0x03
    .short 0x0028
    .short 0x0078
    .byte 0x01
    .byte 0x01
    .short 0x0007
    .short 0xEEEF
    .byte 0x00
    .short 0x0078
    .short 0x00A8
    .byte 0x01
    .byte 0x00
    .byte 0x00
    .short 0x0008
    .short 0xEEEF
    .byte 0x00
    .short 0x0088
    .short 0x00A8
    .byte 0x01
    .byte 0x00
    .byte 0x01
    .short 0xFD13

    .balign 4, 0
_00A0:
    .short 0x0003
    .short 0x800B
    .byte 0x01
    .short 0x0088
    .short 0x0038
    .byte 0x01
    .byte 0x01
    .short 0x0004
    .short 0x800C
    .byte 0x01
    .short 0x0078
    .short 0x0038
    .byte 0x01
    .byte 0x01
    .short 0xFD13

    .balign 4, 0
_00B8:
    .short 0x0004
    .short 0x0001
    .short 0x0006
    .short 0x0003
    .short 0x0004
    .short 0x0003
    .short 0x0003
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_00CC:
    .short 0x0004
    .short 0x0001
    .short 0x0006
    .short 0x0004
    .short 0x0004
    .short 0x0002
    .short 0x0003
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_00E0:
    .short 0x0005
    .short 0x0001
    .short 0x0007
    .short 0x0003
    .short 0x0005
    .short 0x0003
    .short 0x0002
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_00F4:
    .short 0x0005
    .short 0x0001
    .short 0x0007
    .short 0x0004
    .short 0x0005
    .short 0x0002
    .short 0x0002
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0108:
    .short 0x0007
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0110:
    .short 0x0006
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0118:
    .short 0x0016
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0120:
    .short 0x0004
    .short 0x0003
    .short 0x0006
    .short 0x0002
    .short 0x0004
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0130:
    .short 0x0004
    .short 0x0002
    .short 0x0006
    .short 0x0003
    .short 0x0004
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0140:
    .short 0x0006
    .short 0x0001
    .short 0x0002
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_014C:
    .short 0x0007
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_0154:
    .short 0x0003
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_015C:
    .short 0x0002
    .short 0x0001
    .short 0x0006
    .short 0x0001
    .short 0x0003
    .short 0x0001
    .short 0xFD13

    .balign 4, 0
_016C:
    .short 0x0002
    .short 0x0001
    .short 0xFD13

_0172:
    FrontierScrCmd_6C
    Call _0BCF
    Call _0C15
    SetVar 0x8006, 0
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _01CE
    GoToIfEq 0x8008, 6, _01CE
    SetVar 0x8001, 5
    SetVar 0x8002, 6
    SetVar 0x800F, 232
    FrontierScrCmd_22 _0008
    FrontierScrCmd_24 _0028
    GoTo _01F8
    End

_01CE:
    FrontierScrCmd_4A 43
    SetVar 0x8001, 7
    SetVar 0x8002, 8
    SetVar 0x800F, 232
    FrontierScrCmd_22 _0014
    FrontierScrCmd_24 _0064
    GoTo _01F8
    End

_01F8:
    FrontierScrCmd_13 6, 1, 1, 0
    FrontierScrCmd_14
    FrontierScrCmd_3E 0x40DE, 0x8008
    GoToIfEq 0x8008, 1, _0226
    GoToIfEq 0x8008, 2, _04FB
    End

_0226:
    FrontierScrCmd_3D 0x40DE, 3
    Call _025C
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _0270
    GoToIfEq 0x8008, 6, _0270
    GoTo _0965
    End

_025C:
    FrontierScrCmd_28 0x8001, _00B8
    FrontierScrCmd_28 0x8002, _00CC
    FrontierScrCmd_29
    Return

_0270:
    Call _0ACD
    GoToIfEq 0x8003, 0, _077B
    Call _09A5
    GoToIfEq 0x8008, 1, _09B7
    Call _09C5
    Call _09E9
    Call _0A0D
    GoTo _02B0
    End

_02B0:
    FrontierScrCmd_84 33, 0, 0x8008
    FrontierScrCmd_7A 0, 0x8008
    Message BattleTowerMultiBattleRoom_Text_AskReadyForNextPair
    GoToIfEq 0x8006, 0, _02E9
    FrontierScrCmd_1A 31, 13, 0, 0, 0x8008
    FrontierScrCmd_CA 1
    FrontierScrCmd_1C 146, 255, 0
    GoTo _034B
    End

_02E9:
    Call _0C57
    GoToIfEq 0x8008, 1, _0330
    FrontierScrCmd_71 0x8008
    GoToIfEq 0x8008, 0, _0330
    FrontierScrCmd_1A 31, 11, 0, 0, 0x8008
    FrontierScrCmd_CA 1
    FrontierScrCmd_1C 146, 255, 0
    FrontierScrCmd_1C 0x110, 255, 1
    GoTo _034B
    End

_0330:
    FrontierScrCmd_1A 31, 13, 0, 0, 0x8008
    FrontierScrCmd_CA 1
    FrontierScrCmd_1C 146, 255, 0
    GoTo _034B
    End

_034B:
    FrontierScrCmd_1C 148, 255, 2
    FrontierScrCmd_1D
    FrontierScrCmd_12
    SetVar 0x8000, 0
    GoToIfEq 0x8008, 2, _0B27
    GoToIfEq 0x8008, 1, _0B65
    GoTo _037F
    End

_037F:
    SetVar 0x8006, 0
    Message BattleTowerMultiBattleRoom_Text_AwaitingResponseFromFriend
    FrontierScrCmd_36
    FrontierScrCmd_35 5
    FrontierScrCmd_84 58, 0, 0x8008
    GoTo _039F
    End

_039F:
    FrontierScrCmd_89 2, 0x8000, 0x8008
    GoToIfEq 0x8008, 0, _039F
    FrontierScrCmd_8A 2, 0x8000
    FrontierScrCmd_12
    SetVar 0x8010, 0x8000
    GoToIfEq 0x8010, 1, _0B4B
    Call _0605
    GoTo _0270
    End

_03DD:
    FrontierScrCmd_6F
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _0437
    GoToIfEq 0x8008, 6, _0443
    WaitTime 30, 0x8008
    FrontierScrCmd_3D 0x40D8, 1
    FrontierScrCmd_13 6, 1, 0, 0
    FrontierScrCmd_14
    FrontierScrCmd_25 0
    FrontierScrCmd_25 1
    FrontierScrCmd_25 2
    FrontierScrCmd_25 5
    FrontierScrCmd_25 6
    FrontierScrCmd_23 0x800F
    FrontierScrCmd_23 0x800A
    FrontierScrCmd_02

_0437:
    FrontierScrCmd_C8 1
    GoTo _0443
    End

_0443:
    WaitTime 30, 0x8008
    FrontierScrCmd_3D 0x40D8, 1
    FrontierScrCmd_36
    FrontierScrCmd_35 6
    CallIfEq 0x8004, 100, _04D1
    FrontierScrCmd_84 43, 0, 0x8008
    CallIfEq 0x8008, 6, _04DF
    FrontierScrCmd_13 6, 1, 0, 0
    FrontierScrCmd_14
    FrontierScrCmd_36
    FrontierScrCmd_35 8
    FrontierScrCmd_84 43, 0, 0x8008
    CallIfEq 0x8008, 3, _04F7
    FrontierScrCmd_25 0
    FrontierScrCmd_25 1
    FrontierScrCmd_25 2
    FrontierScrCmd_25 7
    FrontierScrCmd_25 8
    FrontierScrCmd_23 0x800F
    FrontierScrCmd_23 0x800A
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 6, _04D5
    FrontierScrCmd_02

_04D1:
    FrontierScrCmd_12
    Return

_04D5:
    FrontierScrCmd_B6
    FrontierScrCmd_04 14, 1
    End

_04DF:
    MessageInstant BattleTowerMultiBattleRoom_Text_SavingDontTurnOffPower2
    ShowSavingIcon
    FrontierScrCmd_73 0x8008
    HideSavingIcon
    PlaySoundEffect SEQ_SE_DP_SAVE
    WaitSoundEffect SEQ_SE_DP_SAVE
    FrontierScrCmd_12
    Return

_04F7:
    FrontierScrCmd_37
    Return

_04FB:
    FrontierScrCmd_3D 0x40DE, 3
    SetVar 0x8006, 1
    Call _025C
    Call _051B
    GoTo _053F
    End

_051B:
    FrontierScrCmd_28 1, _014C
    FrontierScrCmd_28 2, _014C
    FrontierScrCmd_28 0x8001, _016C
    FrontierScrCmd_28 0x8002, _016C
    FrontierScrCmd_29
    Return

_053F:
    FrontierScrCmd_84 33, 0, 0x8008
    FrontierScrCmd_7A 0, 0x8008
    Message BattleTowerMultiBattleRoom_Text_AskReadyForNextPair
    GoToIfEq 0x8006, 0, _0578
    FrontierScrCmd_1A 31, 11, 0, 0, 0x8008
    FrontierScrCmd_CA 1
    FrontierScrCmd_1C 146, 255, 0
    GoTo _059B
    End

_0578:
    FrontierScrCmd_1A 31, 9, 0, 0, 0x8008
    FrontierScrCmd_CA 1
    FrontierScrCmd_1C 146, 255, 0
    FrontierScrCmd_1C 0x110, 255, 1
    GoTo _059B
    End

_059B:
    FrontierScrCmd_1C 147, 255, 2
    FrontierScrCmd_1C 148, 255, 3
    FrontierScrCmd_1D
    FrontierScrCmd_12
    SetVar 0x8010, 0x8008
    GoToIfEq 0x8010, 0, _05F1
    GoToIfEq 0x8010, 1, _0629
    GoToIfEq 0x8010, 2, _06E7
    GoToIfEq 0x8010, 3, _0745
    GoTo _05F1
    End

_05F1:
    Call _0605
    SetVar 0x8006, 0
    GoTo _0965
    End

_0605:
    FrontierScrCmd_28 0x8001, _0154
    FrontierScrCmd_28 0x8002, _0154
    FrontierScrCmd_28 1, _015C
    FrontierScrCmd_28 2, _015C
    FrontierScrCmd_29
    Return

_0629:
    FrontierScrCmd_70 0x8008
    CallIfEq 0x8008, 0, _06DB
    CallIfEq 0x8008, 1, _06E1
    ShowYesNoMenu 0x8008, MENU_NO
    GoToIfEq 0x8008, 1, _053F
    Call _0667
    GoTo _053F
    End

_0667:
    Call _0689
    GoTo _0693
    End

_0675:
    Call _0689
    AddVar 0x8005, 1
    GoTo _0693
    End

_0689:
    FrontierScrCmd_84 36, 0, 0x8005
    Return

_0693:
    GoTo _069B
    End

_069B:
    SetVar 0x8006, 1
    MessageInstant BattleTowerMultiBattleRoom_Text_SavingDontTurnOffPower
    FrontierScrCmd_84 43, 0, 0x8008
    ShowSavingIcon
    FrontierScrCmd_6D 1, 0x8008, 0x8005, 0x8005
    HideSavingIcon
    GoToIfEq 0x8005, 1, _06CE
    Message BattleTowerMultiBattleRoom_Text_BattleVideoCouldntBeSaved
    Return

_06CE:
    PlaySoundEffect SEQ_SE_DP_SAVE
    FrontierScrCmd_7B 0
    Message BattleTowerMultiBattleRoom_Text_BattleHasBeenSaved
    Return

_06DB:
    Message BattleTowerMultiBattleRoom_Text_AskSaveBattleVideo
    Return

_06E1:
    Message BattleTowerMultiBattleRoom_Text_AskDeleteExistingBattleVideo
    Return

_06E7:
    Message BattleTowerMultiBattleRoom_Text_AskSaveAndQuit
    ShowYesNoMenu 0x8008, MENU_YES
    FrontierScrCmd_12
    GoToIfEq 0x8008, 0, _0707
    GoTo _053F
    End

_0707:
    FrontierScrCmd_3D 0x40D8, 2
    FrontierScrCmd_84 39, 0, 0x8008
    FrontierScrCmd_86
    Message BattleTowerMultiBattleRoom_Text_ThanksForParticipating
    ShowSavingIcon
    FrontierScrCmd_72 0x8008
    HideSavingIcon
    PlaySoundEffect SEQ_SE_DP_SAVE
    WaitSoundEffect SEQ_SE_DP_SAVE
    FrontierScrCmd_13 6, 1, 0, 0
    FrontierScrCmd_14
    FrontierScrCmd_12
    FrontierScrCmd_6F
    FrontierScrCmd_84 2, 0, 0x8008
    End

_0745:
    Message BattleTowerMultiBattleRoom_Text_AskCancelChallenge
    ShowYesNoMenu 0x8008, MENU_NO
    FrontierScrCmd_12
    GoToIfEq 0x8008, 0, _0765
    GoTo _053F
    End

_0765:
    FrontierScrCmd_84 37, 0, 0x8008
    SetVar 0x8000, 0
    GoTo _03DD
    End

_077B:
    SetVar 0x8000, 0
    GoTo _087B
    End

_0789:
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _07B3
    GoToIfEq 0x8008, 6, _07B3
    GoTo _07DF
    End

_07B3:
    FrontierScrCmd_71 0x8008
    GoToIfEq 0x8008, 0, _0817
    Call _0C57
    GoToIfEq 0x8008, 1, _0817
    GoTo _07DF
    End

_07DF:
    FrontierScrCmd_70 0x8008
    CallIfEq 0x8008, 0, _06DB
    CallIfEq 0x8008, 1, _06E1
    ShowYesNoMenu 0x8008, MENU_NO
    CallIfEq 0x8008, 0, _095D
    GoTo _0817
    End

_0817:
    FrontierScrCmd_84 38, 0, 0x8008
    Message BattleTowerMultiBattleRoom_Text_YouHaveClearedYourSeventhMatch
    FrontierScrCmd_84 46, 0, 0x8008
    FrontierScrCmd_7A 1, 0x8008
    FrontierScrCmd_7B 0
    Message BattleTowerMultiBattleRoom_Text_PlayerReceivedBP
    PlayFanfare SEQ_PL_POINTGET3
    WaitFanfare
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _0869
    GoToIfEq 0x8008, 6, _0869
    FrontierScrCmd_12
    GoTo _03DD
    End

_0869:
    SetVar 0x8004, 100
    MessageNoSkip BattleTowerMultiBattleRoom_Text_PleaseWait
    GoTo _03DD
    End

_087B:
    SetVar 0x8004, 0
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _08AB
    GoToIfEq 0x8008, 6, _08AB
    GoTo _08E9
    End

_08AB:
    FrontierScrCmd_71 0x8008
    GoToIfEq 0x8008, 0, _08D7
    Call _0C57
    GoToIfEq 0x8008, 1, _0945
    GoTo _08E9
    End

_08D7:
    SetVar 0x8004, 100
    MessageNoSkip BattleTowerMultiBattleRoom_Text_PleaseWait
    GoTo _0945
    End

_08E9:
    FrontierScrCmd_70 0x8008
    CallIfEq 0x8008, 0, _06DB
    CallIfEq 0x8008, 1, _06E1
    ShowYesNoMenu 0x8008, MENU_NO
    CallIfEq 0x8008, 0, _0955
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _08D7
    GoToIfEq 0x8008, 6, _08D7
    FrontierScrCmd_12
    GoTo _0945
    End

_0945:
    FrontierScrCmd_84 37, 0, 0x8008
    GoTo _03DD
    End

_0955:
    Call _0675
    Return

_095D:
    Call _0667
    Return

_0965:
    Call _0A1B
    GoToIfEq 0x8003, 0, _077B
    Call _09A5
    GoToIfEq 0x8008, 1, _09B7
    Call _09C5
    Call _09E9
    Call _0A0D
    GoTo _053F
    End

_09A5:
    FrontierScrCmd_84 34, 0, 0x8008
    FrontierScrCmd_84 35, 0, 0x8008
    Return

_09B7:
    SetVar 0x8000, 1
    GoTo _0789
    End

_09C5:
    FrontierScrCmd_28 3, _0120
    FrontierScrCmd_28 4, _0130
    FrontierScrCmd_29
    FrontierScrCmd_25 3
    FrontierScrCmd_25 4
    FrontierScrCmd_23 0x800B
    FrontierScrCmd_23 0x800C
    Return

_09E9:
    FrontierScrCmd_28 0x8001, _0140
    FrontierScrCmd_28 0x8002, _0140
    FrontierScrCmd_28 1, _014C
    FrontierScrCmd_28 2, _014C
    FrontierScrCmd_29
    Return

_0A0D:
    Message BattleTowerMultiBattleRoom_Text_YourPokemonWillBeRestored
    PlayFanfare SEQ_ASA
    WaitFanfare
    FrontierScrCmd_39
    Return

_0A1B:
    FrontierScrCmd_84 40, 0, 0x8008
    Call _0A61
    Call _0AB5
    FrontierScrCmd_85 0
    FrontierScrCmd_3A
    FrontierScrCmd_12
    Call _0AC1
    FrontierScrCmd_85 1
    FrontierScrCmd_3A
    FrontierScrCmd_12
    Call _0A91
    FrontierScrCmd_3F 0
    FrontierScrCmd_87
    FrontierScrCmd_88 0x8003
    FrontierScrCmd_13 6, 1, 1, 0
    FrontierScrCmd_14
    Return

_0A61:
    FrontierScrCmd_84 41, 0, 0x800B
    FrontierScrCmd_84 41, 1, 0x800C
    FrontierScrCmd_22 _0020
    FrontierScrCmd_24 _00A0
    FrontierScrCmd_28 3, _00E0
    FrontierScrCmd_28 4, _00F4
    FrontierScrCmd_29
    Return

_0A91:
    FrontierScrCmd_28 0x8001, _0108
    FrontierScrCmd_28 0x8002, _0108
    FrontierScrCmd_28 3, _0110
    FrontierScrCmd_28 4, _0110
    FrontierScrCmd_29
    Return

_0AB5:
    FrontierScrCmd_28 3, _0118
    FrontierScrCmd_29
    Return

_0AC1:
    FrontierScrCmd_28 4, _0118
    FrontierScrCmd_29
    Return

_0ACD:
    FrontierScrCmd_84 40, 0, 0x8008
    Call _0A61
    Call _0AB5
    FrontierScrCmd_85 0
    WaitTime 30, 0x8008
    FrontierScrCmd_12
    Call _0AC1
    FrontierScrCmd_85 1
    WaitTime 30, 0x8008
    FrontierScrCmd_12
    Call _0A91
    MessageNoSkip BattleTowerMultiBattleRoom_Text_PleaseWait
    FrontierScrCmd_36
    FrontierScrCmd_35 4
    FrontierScrCmd_12
    FrontierScrCmd_3F 0
    FrontierScrCmd_87
    FrontierScrCmd_88 0x8003
    FrontierScrCmd_13 6, 1, 1, 0
    FrontierScrCmd_14
    Return

_0B27:
    Message BattleTowerMultiBattleRoom_Text_AskCancelChallenge
    ShowYesNoMenu 0x8008, MENU_NO
    GoToIfEq 0x8008, 1, _02B0
    SetVar 0x8000, 1
    GoTo _037F
    End

_0B4B:
    Message BattleTowerMultiBattleRoom_Text_YouHaveChosenToRetire
    WaitTime 30, 0x8008
    FrontierScrCmd_36
    FrontierScrCmd_35 7
    FrontierScrCmd_12
    GoTo _0765
    End

_0B65:
    Call _0C57
    GoToIfEq 0x8008, 1, _02B0
    FrontierScrCmd_71 0x8008
    GoToIfEq 0x8008, 0, _02B0
    GoTo _0B91
    End

_0B91:
    FrontierScrCmd_70 0x8008
    CallIfEq 0x8008, 0, _06DB
    CallIfEq 0x8008, 1, _06E1
    ShowYesNoMenu 0x8008, MENU_NO
    GoToIfEq 0x8008, 1, _02B0
    Call _0667
    GoTo _02B0
    End

_0BCF:
    FrontierScrCmd_3E 0x40DE, 0x8008
    GoToIfEq 0x8008, 0, _0C01
    GoToIfEq 0x8000, 1, _0C03
    FrontierScrCmd_84 55, 0, 0x8009
    FrontierScrCmd_84 55, 1, 0x800A
    Return

_0C01:
    Return

_0C03:
    FrontierScrCmd_84 55, 0, 0x8009
    FrontierScrCmd_84 55, 1, 0x800A
    Return

_0C15:
    FrontierScrCmd_3E 0x40DE, 0x8008
    CallIfNe 0x8008, 0, _0C4B
    GoTo _0C30
    End

_0C30:
    FrontierScrCmd_3E 0x40DE, 0x8008
    GoToIfEq 0x8008, 3, _0C4D
    GoTo _0C55
    End

_0C4B:
    Return

_0C4D:
    GoTo _0C55
    End

_0C55:
    Return

_0C57:
    FrontierScrCmd_84 43, 0, 0x8008
    GoToIfEq 0x8008, 3, _0C74
    SetVar 0x8008, 0
    Return

_0C74:
    FrontierScrCmd_4B 0x8008
    GoToIfEq 0x8008, 1, _0C8D
    SetVar 0x8008, 0
    Return

_0C8D:
    SetVar 0x8008, 1
    Return

    .balign 4, 0
